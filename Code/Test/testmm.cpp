/*
 * testmesh.cpp
 *
 * In this program, the
 * 		Spherical Mesh,
 * 		Mat file writing,
 * 		Vector3's spherical, cart2spher functions are tested
 *
 * are be tested.
 *  Created on: Mar 15, 2011
 *      Author: xiaochuanq
 */

#include "desc.h"
#include "dataio.h"
#include "myexception.hpp"
//data:
/*
 * theta : mostly from -pi/4 : -pi/6 and pi/6 : pi/4;
 * phi: .42pi : .5pi and -.6pi : -.5pi
 * r : 10: 15 and 10:15
 *
 * phi_delta = theta_delta = pi/12
 * totally 24 phi bins and 12 theta bins
 * r bins' number depends on rmax and dr
 * we set rmax = 20 and dr = 5
 *
 * theta bins: matlab bin #4 and #9    C: should be 3, 8
 * phi bins : matlab bin #18 and #6    C:           17, 5
 * r bins: matlab bin #3	, C: 			2
 * so, the spikes of unblurred one should be at
 * m: C: 5 * 12 + 8 and 17 * 12 + 3    Matlab: 69, 208
 * n: C: 2					, Matlab: 3
 */
void GeneratePoints(vector<Vector3>& vv3) {

	static const float data[] =
			{ 0.8283, 8.4041, -7.7521, 1.5727, 10.2397, -6.1898, 1.8401,
					8.4939, -6.0969, 2.3648, 9.5616, -7.5354, 1.5728, 10.8489,
					-7.7158, 1.8158, 8.8253, -6.6642, 0.7690, 11.2574, -7.9084,
					1.3041, 8.2594, -6.1872, 0.3895, 9.8781, -6.6618, 0.5324,
					8.0422, -6.0305, 1.0226, 9.5480, -5.5641, 1.5398, 7.4159,
					-6.6152, 0.0852, 8.0403, -7.4309, 1.4327, 7.7537, -7.2727,
					0.1545, 8.2334, -7.7721, 1.6341, 8.3589, -6.7711, 1.3119,
					8.3521, -6.5723, 2.2536, 9.7590, -8.1214, 1.0697, 11.9196,
					-7.8821, 2.3969, 11.5984, -8.3864, 2.1842, 9.0228, -6.0863,
					0.7282, 10.5595, -6.3490, 1.6498, 10.0758, -5.9874, 0.7915,
					9.3550, -8.3101, 1.2772, 8.2696, -7.6063, 0.7929, 8.5309,
					-5.8506, 2.1391, 8.6169, -8.2541, 0.1938, 8.7106, -6.5092,
					0.4045, 8.1480, -6.0792, 0.7815, 12.3467, -7.7241, 0.4468,
					9.6059, -7.3365, 1.7442, 11.2829, -9.1281, 1.0685, 11.1915,
					-7.7794, 0.8843, 8.3447, -5.5937, 1.2394, 10.5559, -7.9624,
					1.8601, 10.2046, -8.4885, 1.8075, 9.5592, -8.7943, 1.3958,
					10.1709, -7.4310, 1.6089, 8.2731, -7.2019, 0.4829, 9.9203,
					-9.4636, 0.0321, 9.2845, -6.1435, 2.1365, 8.6837, -7.7164,
					1.2978, 11.1876, -8.7822, 2.6207, 11.3432, -7.9860, 0.4565,
					9.2674, -7.5489, 0.0259, 9.6114, -6.4239, 2.3251, 9.8391,
					-8.0781, 0.1785, 11.8426, -8.1435, 2.8725, 11.5288,
					-8.0797, 0.7966, 10.1098, -7.9081, 0.4500, 8.3577, -8.0744,
					1.2573, 10.8030, -8.9767, 0.2722, 9.5449, -7.5151, 0.2744,
					10.9216, -9.2975, 0.7109, 7.6188, -6.7560, 2.2564, 10.3614,
					-6.7662, 2.0460, 10.3839, -8.3056, 1.8757, 9.0939, -5.7122,
					2.1467, 8.8370, -7.2793, 2.0148, 8.9215, -6.0056, 0.8620,
					9.0087, -7.2233, 0.1511, 10.0671, -6.4708, 1.6873, 10.4189,
					-6.9833, 1.1691, 7.9188, -6.4525, 0.0371, 9.5413, -8.3445,
					0.1289, 9.5240, -6.1824, 0.7733, 9.5945, -5.7204, 0.0251,
					8.6357, -7.1396, 0.5139, 8.8513, -6.1357, 1.8885, 11.3434,
					-8.9842, 1.0267, 12.1986, -7.7606, 2.1773, 11.4458,
					-7.6515, 1.7537, 9.9063, -9.0161, 0.7338, 9.2052, -5.7629,
					1.1916, 10.1011, -5.9065, 1.2762, 8.6582, -6.5756, 0.8446,
					8.5184, -5.2764, 0.5805, 9.3439, -6.7696, 1.0268, 9.8780,
					-8.9562, 1.0864, 9.7055, -8.6106, 1.0226, 9.8377, -7.8536,
					1.2245, 10.0357, -6.7123, 2.1780, 9.3795, -6.1310, 0.7267,
					10.4026, -6.7702, 0.0101, 10.5140, -8.7323, 1.7535,
					10.8290, -8.1588, 0.0669, 9.3559, -8.7150, 1.6187, 9.8707,
					-9.2166, 0.2737, 9.6961, -8.8288, 1.1839, 8.6761, -6.0360,
					1.4412, 9.8090, -7.5237, 1.6928, 8.5909, -7.7594, 1.8024,
					8.1574, -6.3403, 1.3635, 7.8546, -7.2151, 0.5430, 7.9587,
					-7.5613, 0.6054, 11.1990, -7.0428, 0.7423, 9.7279, -7.1567,
					2.7893, 11.0962, -6.8756, 0.3628, 9.3003, -6.3544, 0.1579,
					8.1723, -5.9267, 0.6031, 10.5759, -6.7825, 2.2824, 9.4042,
					-5.9824, 1.9371, 12.4258, -7.3070, 0.7556, 10.2565,
					-10.0159, 0.6799, 10.0909, -6.2996, 1.5868, 8.1223,
					-5.9076, 2.0699, 11.2603, -6.6483, 0.9132, 11.2045,
					-8.3886, 1.5093, 11.5490, -8.9104, 0.8104, 8.6341, -5.5953,
					1.7364, 9.0334, -7.9972, 2.0761, 10.0022, -7.7405, 0.4812,
					11.3503, -6.9380, 0.6307, 10.8685, -7.9275, 0.1811,
					11.1148, -7.0020, 2.4714, 10.9553, -7.4968, 1.9349, 9.3820,
					-6.9343, 2.1572, 9.4660, -8.3608, 1.1024, 8.6403, -6.0434,
					1.5033, 7.3916, -7.0488, 0.3106, 11.9919, -8.5030, 2.0797,
					9.1259, -6.5130, 2.5182, 10.3927, -7.1725, 1.3689, 12.3828,
					-7.6514, 0.5341, 9.4285, -5.5078, 1.5611, 9.0333, -6.0197,
					1.9158, 9.2515, -6.8552, 2.0311, 12.2427, -7.4631, 1.8804,
					9.4486, -6.9952, 0.9919, 8.1013, -7.8840, 0.1848, 7.9361,
					-7.2811, 0.9333, 10.0842, -6.3175, 2.0840, 9.1705, -7.1768,
					1.3628, 8.9267, -5.6890, 2.1217, 8.8568, -7.9915, 1.0443,
					8.3764, -6.2188, 1.4915, 10.4827, -7.4897, 0.0044, 7.2920,
					-6.9914, 0.4871, 10.3885, -7.4156, 1.3667, 10.6250,
					-8.7014, 0.2125, 8.0923, -7.6938, 2.0628, 9.4687, -7.3753,
					1.4435, 9.4418, -8.4525, 0.1378, 7.6239, -6.9862, 0.1912,
					9.3161, -8.1924, 0.6912, 9.6865, -8.7938, 0.7873, 8.2696,
					-7.3638, 1.6505, 10.0150, -9.6801, 0.1906, 11.9802,
					-8.4517, 2.3198, 10.4880, -9.0880, 0.6696, 9.9787, -7.4207,
					0.8247, 9.3554, -6.4171, 0.4496, 10.8296, -8.2086, 1.3374,
					8.8698, -6.6654, 0.7162, 11.4953, -8.9682, 0.3927, 9.5762,
					-8.7774, 1.7220, 10.1223, -7.8113, 1.0233, 9.1516, -5.7754,
					0.0462, 8.9064, -5.5215, 0.9594, 8.5232, -7.2992, 1.7599,
					10.4705, -9.3208, 1.0964, 11.5503, -8.4913, 1.7320,
					10.7999, -7.6946, 0.6409, 10.5698, -8.3650, 1.2156, 8.2799,
					-7.3559, 1.3838, 10.9020, -6.5360, 0.7701, 10.1236,
					-9.4944, 0.0596, 8.7893, -8.1231, 1.8171, 10.7665, -9.9095,
					0.3146, 7.7949, -6.9942, 0.6118, 9.4147, -6.7051, 0.1150,
					10.0857, -7.3482, 1.7879, 7.2816, -7.1172, 1.8430, 11.4239,
					-6.9475, 0.8833, 10.5029, -7.0737, 1.8572, 10.2823,
					-6.9778, 1.9358, 9.9897, -9.6045, 0.8602, 11.9527, -7.4849,
					1.1035, 11.7836, -7.0930, 1.0153, 9.9368, -5.8187, 0.8725,
					10.3065, -6.4658, 2.6795, 11.0992, -7.4308, 1.3627, 8.3397,
					-6.3526, 1.0734, 7.8172, -7.0350, 1.6628, 8.7024, -7.0651,
					0.6564, 9.2471, -8.4477, 0.3786, 10.5798, -10.1556, 2.0482,
					11.3395, -6.8874, 0.5908, 8.8194, -7.4055, 1.8630, 8.5538,
					-7.3558, 0.4413, 10.8617, -8.9629, 2.4225, 11.1338,
					-8.7729, 1.0958, 10.6620, -7.5086, 1.2743, 8.0162, -7.8084,
					0.4255, 8.8457, -5.5873, 1.3924, 11.2249, -8.3038, 1.3760,
					10.7814, -6.8125, 0.3444, 11.2580, -9.2165, 1.3071, 8.0543,
					-6.3508, 1.2705, 9.2208, -8.8258, 0.0772, 8.5110, -7.5904,
					2.7087, 11.1563, -7.9806, 0.0568, 8.4503, -6.9749, 2.0764,
					10.1571, -6.3397, 0.7259, 8.7480, -8.0623, 1.2407, 12.0197,
					-7.0229, 0.8601, 10.6209, -7.9007, 1.4449, 9.0153, -6.1995,
					0.9441, 9.9668, -5.7818, 0.3835, 8.1589, -6.8897, 2.5078,
					10.0765, -8.2133, 2.2832, 9.8466, -7.7914, 0.0568, 9.0671,
					-5.9705, 0.7845, 9.0244, -5.7910, 1.7160, 8.8655, -8.3683,
					1.5849, 10.6046, -9.5572, 2.1297, 9.5977, -7.9968, 1.3409,
					7.2883, -7.0182, 1.5143, 8.1106, -6.1753, 1.7722, 10.5634,
					-8.8183, 1.9041, 8.8964, -8.1193, 1.4400, 8.8024, -7.8283,
					2.5542, 11.5057, -7.1804, 0.2793, 9.6898, -6.6937, 2.2268,
					9.7175, -7.6703, 0.1998, 11.4798, -6.9677, 1.5512, 10.3005,
					-9.6351, 2.2693, 9.3983, -6.4300, 1.7786, 10.7771, -7.3007,
					0.7769, 11.8145, -8.6794, 0.3972, 7.7720, -6.9155, 1.1770,
					10.3539, -7.4989, 0.7179, 9.1800, -7.7198, 0.2252, 8.5111,
					-7.7578, 1.9803, 8.2682, -7.4483, 2.0062, 11.4683, -7.1337,
					2.5302, 10.4650, -10.1217, 1.6456, 8.1142, -7.1452, 0.6943,
					9.9599, -9.4693, 0.5987, 8.6369, -6.7533, 0.3224, 10.6043,
					-10.2670, 1.2256, 11.7589, -7.2350, 2.0717, 8.8030,
					-7.9863, 0.1901, 9.8932, -9.2013, 0.4730, 9.5184, -7.9600,
					1.9405, 10.8119, -8.5056, 0.9758, 8.5609, -7.9791, 0.0341,
					8.9988, -5.2093, 0.7008, 9.8936, -8.1813, 0.4408, 10.9998,
					-9.2415, 1.1204, 7.8962, -7.5329, 1.2172, 9.1918, -7.7801,
					1.0747, 9.7979, -9.3829, 1.4770, 8.0352, -6.1671, 0.7575,
					12.1193, -8.0067, 1.3746, 11.0837, -7.8953, 0.8155, 9.2602,
					-8.6594, 1.3665, 7.8581, -7.4633, 2.2090, 10.1542, -6.7935,
					1.3895, 10.5925, -6.5087, 1.8716, 11.7043, -8.8169, 0.5463,
					10.3566, -9.5682, 0.6736, 12.3156, -7.8523, 0.8444,
					10.2185, -8.4318, 1.9585, 8.9469, -7.7017, 2.9078, 11.7123,
					-8.0224, 0.9671, 8.7993, -8.5793, 1.3981, 7.9588, -7.6843,
					0.1478, 9.8052, -6.7984, 0.0517, 10.8878, -7.8095, 1.7964,
					10.0183, -7.6012, 0.5611, 11.3172, -7.6003, 0.3159,
					12.2231, -8.3007, 1.2238, 12.1853, -7.9881, 0.2776, 9.6210,
					-8.1183, 0.1689, 12.0716, -8.2606, 0.9556, 8.4867, -6.2775,
					0.5431, 8.0270, -6.4224, 0.8780, 8.3100, -7.8945, 2.5728,
					10.4106, -6.9994, 1.3323, 9.6175, -7.9866, 1.0239, 11.6090,
					-8.3398, 1.2473, 10.4245, -6.9985, 1.3815, 8.7777, -8.2158,
					0.1457, 9.3197, -8.5194, 0.4582, 10.8006, -7.9756, 0.3022,
					8.0480, -6.1432, 1.8348, 11.6617, -7.2514, 0.9101, 8.9640,
					-5.8211, 0.3246, 10.2366, -6.8525, 0.1352, 8.1713, -7.7604,
					0.7085, 8.5733, -8.0815, 1.8916, 9.4636, -8.9959, 0.7839,
					9.0836, -5.8923, 2.2346, 9.5098, -5.8262, 1.3316, 8.9592,
					-6.2268, 0.6710, 8.0821, -7.3970, 0.1586, 9.6231, -6.4798,
					0.4918, 10.4512, -9.6472, 1.1568, 8.9742, -8.3134, 0.5919,
					9.7720, -6.8855, 1.2142, 8.3158, -6.9436, 0.0843, 12.0120,
					-8.3903, 0.0299, 9.9858, -6.6282, 0.3846, 11.3781, -8.2530,
					1.6340, 10.6678, -7.1987, 1.2097, 8.8658, -7.7520, 2.2011,
					11.6102, -7.9039, 0.6367, 11.8644, -6.9761, 0.3032,
					10.4032, -6.4772, 0.2183, 10.1720, -9.4947, 1.2194,
					11.0554, -9.0159, 0.9359, 9.3496, -7.6060, 2.0154, 9.3785,
					-6.5899, 0.2608, 10.4558, -7.5237, 1.6382, 11.9095,
					-7.8074, 2.0413, 10.1980, -8.4253, 0.2220, 8.8925, -7.8185,
					0.5843, 9.8836, -9.2376, 0.3564, 12.1895, -7.9952, 1.6778,
					9.3349, -8.3379, 0.7991, 9.8107, -7.8907, 0.7740, 9.2478,
					-6.8387, 1.6972, 7.6558, -6.8137, 1.3115, 8.8325, -6.2762,
					1.4952, 8.2056, -6.3646, 0.6402, 9.0698, -8.2116, 1.4990,
					8.3215, -5.5136, 0.2726, 10.5567, -9.7845, 0.4324, 10.0194,
					-8.4329, 1.1493, 7.5178, -6.5802, 1.0182, 8.1115, -6.0903,
					0.6128, 8.0581, -7.5218, 0.3937, 9.5518, -7.5973, 0.7583,
					7.7863, -7.2331, 0.7835, 7.3806, -6.8369, 1.8879, 11.1573,
					-7.3688, 1.2096, 8.8929, -7.5561, 0.7951, 11.1507, -8.0180,
					0.3003, 10.4414, -6.1547, 0.6619, 9.5192, -7.4786, 2.0518,
					8.2387, -5.8025, 0.6934, 8.5543, -5.6692, 1.1485, 8.1706,
					-6.4660, 1.4711, 10.4525, -7.3662, 1.7927, 8.0317, -7.5901,
					0.5551, 12.0345, -7.2227, 1.7655, 10.4151, -9.3719, 2.0743,
					10.9347, -9.4912, 1.6910, 10.2517, -6.7168, 1.3650, 8.7206,
					-6.7246, 1.0465, 9.2397, -6.1064, 1.0706, 9.7876, -7.8619,
					1.5593, 10.2990, -8.8527, 1.2612, 8.3621, -8.0868, 1.2107,
					9.9961, -6.9607, 0.8758, 10.2571, -8.0802, 0.1389, 11.3812,
					-8.8329, 0.6072, 8.7792, -6.2909, 1.4525, 9.6628, -9.2414,
					0.4112, 9.8282, -8.1811, 2.1636, 9.8934, -6.6368, 2.7250,
					11.4486, -8.0356, 1.9850, 8.5642, -8.0455, 1.6619, 7.8764,
					-7.3493, 1.5993, 9.4258, -8.8948, 1.6138, 9.1991, -9.0629,
					2.2191, 8.8453, -7.1816, 1.2982, 11.2952, -7.9339, 2.7385,
					11.9658, -8.2636, 2.4854, 11.5321, -8.7868, 0.7173, 7.7965,
					-7.2246, 0.3186, 9.1028, -6.4366, 0.0481, 7.4985, -6.8586,
					1.0187, 9.5074, -8.7117, 0.0061, 7.7545, -7.1921, 0.9835,
					8.8205, -8.0549, 1.2760, 10.5369, -9.5074, 1.5714, 9.3527,
					-8.3768, 1.2826, 8.9866, -7.5433, 1.0701, 8.4211, -7.0578,
					2.0941, 8.9017, -7.9914, 0.3090, 11.0629, -9.5101, 2.0907,
					8.8245, -5.5630, 1.4198, 10.0584, -6.9110, 0.4903, 11.3649,
					-8.3655, 1.1502, 7.5801, -6.8122, 0.9627, 9.9829, -8.7888,
					0.4836, 10.7142, -10.0532, 0.2757, 9.7405, -5.9080, 0.1514,
					8.8386, -6.0029, 2.1435, 10.5063, -7.8771, 2.0247, 10.8556,
					-9.1952, 0.2449, 9.6397, -8.6464, 1.1792, 11.6199, -8.2940,
					1.1672, 9.4107, -5.5129, 0.9769, 10.1130, -9.0910, 0.3988,
					8.8736, -7.6070, 1.0929, 9.3452, -7.5098, 1.5508, 7.7115,
					-7.3854, 1.5556, 11.3825, -7.8962, 1.4444, 10.0831,
					-8.1070, 0.0989, 11.7122, -6.8291, 1.0243, 10.8069,
					-8.6405, 0.6397, 8.4275, -6.0075, 0.7522, 10.7901, -9.7562,
					1.5642, 9.5448, -7.7810, 1.2154, 10.0685, -9.1167, 1.2464,
					11.2593, -7.4828, 2.4765, 11.6312, -7.3839, 0.9086, 8.3086,
					-6.8292, 0.7640, 10.0459, -6.9194, 1.4130, 9.8384, -8.3574,
					0.4726, 11.6001, -8.6500, 0.7902, 11.8098, -7.5080, 1.8402,
					11.4635, -8.3538, 1.3389, 9.8029, -8.1477, 1.4930, 9.7071,
					-8.2369, 0.6221, 11.1323, -8.6488, 0.5300, 8.0075, -6.3212,
					1.5618, 10.9483, -8.9957, 0.7351, 9.6332, -7.0953, 0.1159,
					8.5072, -5.6674, 0.5730, 10.6672, -8.4074, 0.6207, 8.4610,
					-6.6597, 1.7395, 7.7239, -7.2474, 1.4080, 9.2082, -8.9648,
					0.8745, 8.5657, -7.2543, 1.1949, 8.8334, -7.4071, 2.2940,
					9.5314, -6.8480, 1.9658, 10.1213, -6.1009, 0.4203, 10.1872,
					-6.1060, 2.4820, 9.9348, -7.9217, 0.2781, 8.2003, -7.0882,
					2.0774, 8.9006, -6.0185, 0.7204, 8.7328, -5.7843, 1.1950,
					9.5644, -6.4272, 2.2049, 11.1936, -7.5950, 0.8718, 8.1513,
					-7.5755, 2.4205, 10.9104, -7.6917, 0.8629, 10.5276,
					-8.1488, 1.0442, 10.4507, -9.2031, 2.3850, 9.9707, -9.5088,
					2.2440, 9.3853, -6.1510, 1.7979, 8.4032, -7.6715, 2.2517,
					9.0508, -8.3740, 1.3338, 9.4322, -6.6108, 0.4980, 11.9270,
					-7.3167, 1.0562, 11.0660, -8.3431, 1.2497, 10.4212,
					-7.1428, 0.2840, 8.3839, -7.5695, 2.5425, 11.1390, -6.7741,
					0.2050, 8.9637, -6.6448, 2.2138, 9.8149, -6.9316, 1.0285,
					8.5205, -8.2097, 2.2435, 10.3679, -6.8150, 1.3449, 12.2232,
					-8.1646, 2.4624, 9.7421, -9.2198, 0.6833, 11.7616, -8.8034,
					0.3236, 8.5960, -7.1180, 0.2090, 10.0996, -7.4649, 0.0261,
					8.0490, -6.4176, 1.3140, 10.6223, -8.4635, 1.7377, 9.4846,
					-8.5834, 2.3777, 10.4534, -9.1920, 1.2959, 10.5344,
					-10.2344, 1.2744, 12.3218, -7.4690, 0.5796, 9.8166,
					-6.8690, 1.9489, 8.3963, -5.1710, 0.7893, 9.3564, -8.4308,
					1.1323, 9.3799, -5.7049, 1.9059, 9.1128, -6.0289, 0.1433,
					9.3789, -6.8205, 0.8420, 8.2381, -6.4650, 1.4325, 10.2301,
					-8.8473, 0.1638, 11.3396, -7.5162, 0.8149, 9.4988, -8.2850,
					1.1520, 8.3994, -7.9992, 0.4664, 11.6929, -7.6915, 1.2088,
					10.3520, -7.2128, 1.3391, 12.0199, -8.1756, 0.9294,
					11.6551, -8.2175, 1.4449, 9.1047, -7.2749, 1.8565, 9.6952,
					-7.9033, 1.0298, 9.7978, -6.3053, 0.3312, 9.9992, -8.3139,
					1.7125, 11.5223, -7.4620, 2.4954, 11.1227, -7.4044, 1.2434,
					8.9321, -5.6583, 1.9291, 10.9712, -8.4078, 1.2327, 8.2188,
					-5.8608, 0.4282, 10.3253, -6.1359, 1.5766, 10.5512,
					-8.3121, 1.5108, 9.8849, -9.4545, 1.5861, 9.8870, -6.2325,
					2.3546, 10.8432, -7.8434, 2.0263, 10.8872, -9.0287, 2.1836,
					9.4483, -5.6084, 1.1375, 7.9618, -7.0051, 1.6739, 8.9584,
					-6.3701, -0.8283, -8.4041, 7.7521, -1.5727, -10.2397,
					6.1898, -1.8401, -8.4939, 6.0969, -2.3648, -9.5616, 7.5354,
					-1.5728, -10.8489, 7.7158, -1.8158, -8.8253, 6.6642,
					-0.7690, -11.2574, 7.9084, -1.3041, -8.2594, 6.1872,
					-0.3895, -9.8781, 6.6618, -0.5324, -8.0422, 6.0305,
					-1.0226, -9.5480, 5.5641, -1.5398, -7.4159, 6.6152,
					-0.0852, -8.0403, 7.4309, -1.4327, -7.7537, 7.2727,
					-0.1545, -8.2334, 7.7721, -1.6341, -8.3589, 6.7711,
					-1.3119, -8.3521, 6.5723, -2.2536, -9.7590, 8.1214,
					-1.0697, -11.9196, 7.8821, -2.3969, -11.5984, 8.3864,
					-2.1842, -9.0228, 6.0863, -0.7282, -10.5595, 6.3490,
					-1.6498, -10.0758, 5.9874, -0.7915, -9.3550, 8.3101,
					-1.2772, -8.2696, 7.6063, -0.7929, -8.5309, 5.8506,
					-2.1391, -8.6169, 8.2541, -0.1938, -8.7106, 6.5092,
					-0.4045, -8.1480, 6.0792, -0.7815, -12.3467, 7.7241,
					-0.4468, -9.6059, 7.3365, -1.7442, -11.2829, 9.1281,
					-1.0685, -11.1915, 7.7794, -0.8843, -8.3447, 5.5937,
					-1.2394, -10.5559, 7.9624, -1.8601, -10.2046, 8.4885,
					-1.8075, -9.5592, 8.7943, -1.3958, -10.1709, 7.4310,
					-1.6089, -8.2731, 7.2019, -0.4829, -9.9203, 9.4636,
					-0.0321, -9.2845, 6.1435, -2.1365, -8.6837, 7.7164,
					-1.2978, -11.1876, 8.7822, -2.6207, -11.3432, 7.9860,
					-0.4565, -9.2674, 7.5489, -0.0259, -9.6114, 6.4239,
					-2.3251, -9.8391, 8.0781, -0.1785, -11.8426, 8.1435,
					-2.8725, -11.5288, 8.0797, -0.7966, -10.1098, 7.9081,
					-0.4500, -8.3577, 8.0744, -1.2573, -10.8030, 8.9767,
					-0.2722, -9.5449, 7.5151, -0.2744, -10.9216, 9.2975,
					-0.7109, -7.6188, 6.7560, -2.2564, -10.3614, 6.7662,
					-2.0460, -10.3839, 8.3056, -1.8757, -9.0939, 5.7122,
					-2.1467, -8.8370, 7.2793, -2.0148, -8.9215, 6.0056,
					-0.8620, -9.0087, 7.2233, -0.1511, -10.0671, 6.4708,
					-1.6873, -10.4189, 6.9833, -1.1691, -7.9188, 6.4525,
					-0.0371, -9.5413, 8.3445, -0.1289, -9.5240, 6.1824,
					-0.7733, -9.5945, 5.7204, -0.0251, -8.6357, 7.1396,
					-0.5139, -8.8513, 6.1357, -1.8885, -11.3434, 8.9842,
					-1.0267, -12.1986, 7.7606, -2.1773, -11.4458, 7.6515,
					-1.7537, -9.9063, 9.0161, -0.7338, -9.2052, 5.7629,
					-1.1916, -10.1011, 5.9065, -1.2762, -8.6582, 6.5756,
					-0.8446, -8.5184, 5.2764, -0.5805, -9.3439, 6.7696,
					-1.0268, -9.8780, 8.9562, -1.0864, -9.7055, 8.6106,
					-1.0226, -9.8377, 7.8536, -1.2245, -10.0357, 6.7123,
					-2.1780, -9.3795, 6.1310, -0.7267, -10.4026, 6.7702,
					-0.0101, -10.5140, 8.7323, -1.7535, -10.8290, 8.1588,
					-0.0669, -9.3559, 8.7150, -1.6187, -9.8707, 9.2166,
					-0.2737, -9.6961, 8.8288, -1.1839, -8.6761, 6.0360,
					-1.4412, -9.8090, 7.5237, -1.6928, -8.5909, 7.7594,
					-1.8024, -8.1574, 6.3403, -1.3635, -7.8546, 7.2151,
					-0.5430, -7.9587, 7.5613, -0.6054, -11.1990, 7.0428,
					-0.7423, -9.7279, 7.1567, -2.7893, -11.0962, 6.8756,
					-0.3628, -9.3003, 6.3544, -0.1579, -8.1723, 5.9267,
					-0.6031, -10.5759, 6.7825, -2.2824, -9.4042, 5.9824,
					-1.9371, -12.4258, 7.3070, -0.7556, -10.2565, 10.0159,
					-0.6799, -10.0909, 6.2996, -1.5868, -8.1223, 5.9076,
					-2.0699, -11.2603, 6.6483, -0.9132, -11.2045, 8.3886,
					-1.5093, -11.5490, 8.9104, -0.8104, -8.6341, 5.5953,
					-1.7364, -9.0334, 7.9972, -2.0761, -10.0022, 7.7405,
					-0.4812, -11.3503, 6.9380, -0.6307, -10.8685, 7.9275,
					-0.1811, -11.1148, 7.0020, -2.4714, -10.9553, 7.4968,
					-1.9349, -9.3820, 6.9343, -2.1572, -9.4660, 8.3608,
					-1.1024, -8.6403, 6.0434, -1.5033, -7.3916, 7.0488,
					-0.3106, -11.9919, 8.5030, -2.0797, -9.1259, 6.5130,
					-2.5182, -10.3927, 7.1725, -1.3689, -12.3828, 7.6514,
					-0.5341, -9.4285, 5.5078, -1.5611, -9.0333, 6.0197,
					-1.9158, -9.2515, 6.8552, -2.0311, -12.2427, 7.4631,
					-1.8804, -9.4486, 6.9952, -0.9919, -8.1013, 7.8840,
					-0.1848, -7.9361, 7.2811, -0.9333, -10.0842, 6.3175,
					-2.0840, -9.1705, 7.1768, -1.3628, -8.9267, 5.6890,
					-2.1217, -8.8568, 7.9915, -1.0443, -8.3764, 6.2188,
					-1.4915, -10.4827, 7.4897, -0.0044, -7.2920, 6.9914,
					-0.4871, -10.3885, 7.4156, -1.3667, -10.6250, 8.7014,
					-0.2125, -8.0923, 7.6938, -2.0628, -9.4687, 7.3753,
					-1.4435, -9.4418, 8.4525, -0.1378, -7.6239, 6.9862,
					-0.1912, -9.3161, 8.1924, -0.6912, -9.6865, 8.7938,
					-0.7873, -8.2696, 7.3638, -1.6505, -10.0150, 9.6801,
					-0.1906, -11.9802, 8.4517, -2.3198, -10.4880, 9.0880,
					-0.6696, -9.9787, 7.4207, -0.8247, -9.3554, 6.4171,
					-0.4496, -10.8296, 8.2086, -1.3374, -8.8698, 6.6654,
					-0.7162, -11.4953, 8.9682, -0.3927, -9.5762, 8.7774,
					-1.7220, -10.1223, 7.8113, -1.0233, -9.1516, 5.7754,
					-0.0462, -8.9064, 5.5215, -0.9594, -8.5232, 7.2992,
					-1.7599, -10.4705, 9.3208, -1.0964, -11.5503, 8.4913,
					-1.7320, -10.7999, 7.6946, -0.6409, -10.5698, 8.3650,
					-1.2156, -8.2799, 7.3559, -1.3838, -10.9020, 6.5360,
					-0.7701, -10.1236, 9.4944, -0.0596, -8.7893, 8.1231,
					-1.8171, -10.7665, 9.9095, -0.3146, -7.7949, 6.9942,
					-0.6118, -9.4147, 6.7051, -0.1150, -10.0857, 7.3482,
					-1.7879, -7.2816, 7.1172, -1.8430, -11.4239, 6.9475,
					-0.8833, -10.5029, 7.0737, -1.8572, -10.2823, 6.9778,
					-1.9358, -9.9897, 9.6045, -0.8602, -11.9527, 7.4849,
					-1.1035, -11.7836, 7.0930, -1.0153, -9.9368, 5.8187,
					-0.8725, -10.3065, 6.4658, -2.6795, -11.0992, 7.4308,
					-1.3627, -8.3397, 6.3526, -1.0734, -7.8172, 7.0350,
					-1.6628, -8.7024, 7.0651, -0.6564, -9.2471, 8.4477,
					-0.3786, -10.5798, 10.1556, -2.0482, -11.3395, 6.8874,
					-0.5908, -8.8194, 7.4055, -1.8630, -8.5538, 7.3558,
					-0.4413, -10.8617, 8.9629, -2.4225, -11.1338, 8.7729,
					-1.0958, -10.6620, 7.5086, -1.2743, -8.0162, 7.8084,
					-0.4255, -8.8457, 5.5873, -1.3924, -11.2249, 8.3038,
					-1.3760, -10.7814, 6.8125, -0.3444, -11.2580, 9.2165,
					-1.3071, -8.0543, 6.3508, -1.2705, -9.2208, 8.8258,
					-0.0772, -8.5110, 7.5904, -2.7087, -11.1563, 7.9806,
					-0.0568, -8.4503, 6.9749, -2.0764, -10.1571, 6.3397,
					-0.7259, -8.7480, 8.0623, -1.2407, -12.0197, 7.0229,
					-0.8601, -10.6209, 7.9007, -1.4449, -9.0153, 6.1995,
					-0.9441, -9.9668, 5.7818, -0.3835, -8.1589, 6.8897,
					-2.5078, -10.0765, 8.2133, -2.2832, -9.8466, 7.7914,
					-0.0568, -9.0671, 5.9705, -0.7845, -9.0244, 5.7910,
					-1.7160, -8.8655, 8.3683, -1.5849, -10.6046, 9.5572,
					-2.1297, -9.5977, 7.9968, -1.3409, -7.2883, 7.0182,
					-1.5143, -8.1106, 6.1753, -1.7722, -10.5634, 8.8183,
					-1.9041, -8.8964, 8.1193, -1.4400, -8.8024, 7.8283,
					-2.5542, -11.5057, 7.1804, -0.2793, -9.6898, 6.6937,
					-2.2268, -9.7175, 7.6703, -0.1998, -11.4798, 6.9677,
					-1.5512, -10.3005, 9.6351, -2.2693, -9.3983, 6.4300,
					-1.7786, -10.7771, 7.3007, -0.7769, -11.8145, 8.6794,
					-0.3972, -7.7720, 6.9155, -1.1770, -10.3539, 7.4989,
					-0.7179, -9.1800, 7.7198, -0.2252, -8.5111, 7.7578,
					-1.9803, -8.2682, 7.4483, -2.0062, -11.4683, 7.1337,
					-2.5302, -10.4650, 10.1217, -1.6456, -8.1142, 7.1452,
					-0.6943, -9.9599, 9.4693, -0.5987, -8.6369, 6.7533,
					-0.3224, -10.6043, 10.2670, -1.2256, -11.7589, 7.2350,
					-2.0717, -8.8030, 7.9863, -0.1901, -9.8932, 9.2013,
					-0.4730, -9.5184, 7.9600, -1.9405, -10.8119, 8.5056,
					-0.9758, -8.5609, 7.9791, -0.0341, -8.9988, 5.2093,
					-0.7008, -9.8936, 8.1813, -0.4408, -10.9998, 9.2415,
					-1.1204, -7.8962, 7.5329, -1.2172, -9.1918, 7.7801,
					-1.0747, -9.7979, 9.3829, -1.4770, -8.0352, 6.1671,
					-0.7575, -12.1193, 8.0067, -1.3746, -11.0837, 7.8953,
					-0.8155, -9.2602, 8.6594, -1.3665, -7.8581, 7.4633,
					-2.2090, -10.1542, 6.7935, -1.3895, -10.5925, 6.5087,
					-1.8716, -11.7043, 8.8169, -0.5463, -10.3566, 9.5682,
					-0.6736, -12.3156, 7.8523, -0.8444, -10.2185, 8.4318,
					-1.9585, -8.9469, 7.7017, -2.9078, -11.7123, 8.0224,
					-0.9671, -8.7993, 8.5793, -1.3981, -7.9588, 7.6843,
					-0.1478, -9.8052, 6.7984, -0.0517, -10.8878, 7.8095,
					-1.7964, -10.0183, 7.6012, -0.5611, -11.3172, 7.6003,
					-0.3159, -12.2231, 8.3007, -1.2238, -12.1853, 7.9881,
					-0.2776, -9.6210, 8.1183, -0.1689, -12.0716, 8.2606,
					-0.9556, -8.4867, 6.2775, -0.5431, -8.0270, 6.4224,
					-0.8780, -8.3100, 7.8945, -2.5728, -10.4106, 6.9994,
					-1.3323, -9.6175, 7.9866, -1.0239, -11.6090, 8.3398,
					-1.2473, -10.4245, 6.9985, -1.3815, -8.7777, 8.2158,
					-0.1457, -9.3197, 8.5194, -0.4582, -10.8006, 7.9756,
					-0.3022, -8.0480, 6.1432, -1.8348, -11.6617, 7.2514,
					-0.9101, -8.9640, 5.8211, -0.3246, -10.2366, 6.8525,
					-0.1352, -8.1713, 7.7604, -0.7085, -8.5733, 8.0815,
					-1.8916, -9.4636, 8.9959, -0.7839, -9.0836, 5.8923,
					-2.2346, -9.5098, 5.8262, -1.3316, -8.9592, 6.2268,
					-0.6710, -8.0821, 7.3970, -0.1586, -9.6231, 6.4798,
					-0.4918, -10.4512, 9.6472, -1.1568, -8.9742, 8.3134,
					-0.5919, -9.7720, 6.8855, -1.2142, -8.3158, 6.9436,
					-0.0843, -12.0120, 8.3903, -0.0299, -9.9858, 6.6282,
					-0.3846, -11.3781, 8.2530, -1.6340, -10.6678, 7.1987,
					-1.2097, -8.8658, 7.7520, -2.2011, -11.6102, 7.9039,
					-0.6367, -11.8644, 6.9761, -0.3032, -10.4032, 6.4772,
					-0.2183, -10.1720, 9.4947, -1.2194, -11.0554, 9.0159,
					-0.9359, -9.3496, 7.6060, -2.0154, -9.3785, 6.5899,
					-0.2608, -10.4558, 7.5237, -1.6382, -11.9095, 7.8074,
					-2.0413, -10.1980, 8.4253, -0.2220, -8.8925, 7.8185,
					-0.5843, -9.8836, 9.2376, -0.3564, -12.1895, 7.9952,
					-1.6778, -9.3349, 8.3379, -0.7991, -9.8107, 7.8907,
					-0.7740, -9.2478, 6.8387, -1.6972, -7.6558, 6.8137,
					-1.3115, -8.8325, 6.2762, -1.4952, -8.2056, 6.3646,
					-0.6402, -9.0698, 8.2116, -1.4990, -8.3215, 5.5136,
					-0.2726, -10.5567, 9.7845, -0.4324, -10.0194, 8.4329,
					-1.1493, -7.5178, 6.5802, -1.0182, -8.1115, 6.0903,
					-0.6128, -8.0581, 7.5218, -0.3937, -9.5518, 7.5973,
					-0.7583, -7.7863, 7.2331, -0.7835, -7.3806, 6.8369,
					-1.8879, -11.1573, 7.3688, -1.2096, -8.8929, 7.5561,
					-0.7951, -11.1507, 8.0180, -0.3003, -10.4414, 6.1547,
					-0.6619, -9.5192, 7.4786, -2.0518, -8.2387, 5.8025,
					-0.6934, -8.5543, 5.6692, -1.1485, -8.1706, 6.4660,
					-1.4711, -10.4525, 7.3662, -1.7927, -8.0317, 7.5901,
					-0.5551, -12.0345, 7.2227, -1.7655, -10.4151, 9.3719,
					-2.0743, -10.9347, 9.4912, -1.6910, -10.2517, 6.7168,
					-1.3650, -8.7206, 6.7246, -1.0465, -9.2397, 6.1064,
					-1.0706, -9.7876, 7.8619, -1.5593, -10.2990, 8.8527,
					-1.2612, -8.3621, 8.0868, -1.2107, -9.9961, 6.9607,
					-0.8758, -10.2571, 8.0802, -0.1389, -11.3812, 8.8329,
					-0.6072, -8.7792, 6.2909, -1.4525, -9.6628, 9.2414,
					-0.4112, -9.8282, 8.1811, -2.1636, -9.8934, 6.6368,
					-2.7250, -11.4486, 8.0356, -1.9850, -8.5642, 8.0455,
					-1.6619, -7.8764, 7.3493, -1.5993, -9.4258, 8.8948,
					-1.6138, -9.1991, 9.0629, -2.2191, -8.8453, 7.1816,
					-1.2982, -11.2952, 7.9339, -2.7385, -11.9658, 8.2636,
					-2.4854, -11.5321, 8.7868, -0.7173, -7.7965, 7.2246,
					-0.3186, -9.1028, 6.4366, -0.0481, -7.4985, 6.8586,
					-1.0187, -9.5074, 8.7117, -0.0061, -7.7545, 7.1921,
					-0.9835, -8.8205, 8.0549, -1.2760, -10.5369, 9.5074,
					-1.5714, -9.3527, 8.3768, -1.2826, -8.9866, 7.5433,
					-1.0701, -8.4211, 7.0578, -2.0941, -8.9017, 7.9914,
					-0.3090, -11.0629, 9.5101, -2.0907, -8.8245, 5.5630,
					-1.4198, -10.0584, 6.9110, -0.4903, -11.3649, 8.3655,
					-1.1502, -7.5801, 6.8122, -0.9627, -9.9829, 8.7888,
					-0.4836, -10.7142, 10.0532, -0.2757, -9.7405, 5.9080,
					-0.1514, -8.8386, 6.0029, -2.1435, -10.5063, 7.8771,
					-2.0247, -10.8556, 9.1952, -0.2449, -9.6397, 8.6464,
					-1.1792, -11.6199, 8.2940, -1.1672, -9.4107, 5.5129,
					-0.9769, -10.1130, 9.0910, -0.3988, -8.8736, 7.6070,
					-1.0929, -9.3452, 7.5098, -1.5508, -7.7115, 7.3854,
					-1.5556, -11.3825, 7.8962, -1.4444, -10.0831, 8.1070,
					-0.0989, -11.7122, 6.8291, -1.0243, -10.8069, 8.6405,
					-0.6397, -8.4275, 6.0075, -0.7522, -10.7901, 9.7562,
					-1.5642, -9.5448, 7.7810, -1.2154, -10.0685, 9.1167,
					-1.2464, -11.2593, 7.4828, -2.4765, -11.6312, 7.3839,
					-0.9086, -8.3086, 6.8292, -0.7640, -10.0459, 6.9194,
					-1.4130, -9.8384, 8.3574, -0.4726, -11.6001, 8.6500,
					-0.7902, -11.8098, 7.5080, -1.8402, -11.4635, 8.3538,
					-1.3389, -9.8029, 8.1477, -1.4930, -9.7071, 8.2369,
					-0.6221, -11.1323, 8.6488, -0.5300, -8.0075, 6.3212,
					-1.5618, -10.9483, 8.9957, -0.7351, -9.6332, 7.0953,
					-0.1159, -8.5072, 5.6674, -0.5730, -10.6672, 8.4074,
					-0.6207, -8.4610, 6.6597, -1.7395, -7.7239, 7.2474,
					-1.4080, -9.2082, 8.9648, -0.8745, -8.5657, 7.2543,
					-1.1949, -8.8334, 7.4071, -2.2940, -9.5314, 6.8480,
					-1.9658, -10.1213, 6.1009, -0.4203, -10.1872, 6.1060,
					-2.4820, -9.9348, 7.9217, -0.2781, -8.2003, 7.0882,
					-2.0774, -8.9006, 6.0185, -0.7204, -8.7328, 5.7843,
					-1.1950, -9.5644, 6.4272, -2.2049, -11.1936, 7.5950,
					-0.8718, -8.1513, 7.5755, -2.4205, -10.9104, 7.6917,
					-0.8629, -10.5276, 8.1488, -1.0442, -10.4507, 9.2031,
					-2.3850, -9.9707, 9.5088, -2.2440, -9.3853, 6.1510,
					-1.7979, -8.4032, 7.6715, -2.2517, -9.0508, 8.3740,
					-1.3338, -9.4322, 6.6108, -0.4980, -11.9270, 7.3167,
					-1.0562, -11.0660, 8.3431, -1.2497, -10.4212, 7.1428,
					-0.2840, -8.3839, 7.5695, -2.5425, -11.1390, 6.7741,
					-0.2050, -8.9637, 6.6448, -2.2138, -9.8149, 6.9316,
					-1.0285, -8.5205, 8.2097, -2.2435, -10.3679, 6.8150,
					-1.3449, -12.2232, 8.1646, -2.4624, -9.7421, 9.2198,
					-0.6833, -11.7616, 8.8034, -0.3236, -8.5960, 7.1180,
					-0.2090, -10.0996, 7.4649, -0.0261, -8.0490, 6.4176,
					-1.3140, -10.6223, 8.4635, -1.7377, -9.4846, 8.5834,
					-2.3777, -10.4534, 9.1920, -1.2959, -10.5344, 10.2344,
					-1.2744, -12.3218, 7.4690, -0.5796, -9.8166, 6.8690,
					-1.9489, -8.3963, 5.1710, -0.7893, -9.3564, 8.4308,
					-1.1323, -9.3799, 5.7049, -1.9059, -9.1128, 6.0289,
					-0.1433, -9.3789, 6.8205, -0.8420, -8.2381, 6.4650,
					-1.4325, -10.2301, 8.8473, -0.1638, -11.3396, 7.5162,
					-0.8149, -9.4988, 8.2850, -1.1520, -8.3994, 7.9992,
					-0.4664, -11.6929, 7.6915, -1.2088, -10.3520, 7.2128,
					-1.3391, -12.0199, 8.1756, -0.9294, -11.6551, 8.2175,
					-1.4449, -9.1047, 7.2749, -1.8565, -9.6952, 7.9033,
					-1.0298, -9.7978, 6.3053, -0.3312, -9.9992, 8.3139,
					-1.7125, -11.5223, 7.4620, -2.4954, -11.1227, 7.4044,
					-1.2434, -8.9321, 5.6583, -1.9291, -10.9712, 8.4078,
					-1.2327, -8.2188, 5.8608, -0.4282, -10.3253, 6.1359,
					-1.5766, -10.5512, 8.3121, -1.5108, -9.8849, 9.4545,
					-1.5861, -9.8870, 6.2325, -2.3546, -10.8432, 7.8434,
					-2.0263, -10.8872, 9.0287, -2.1836, -9.4483, 5.6084,
					-1.1375, -7.9618, 7.0051, -1.6739, -8.9584, 6.3701 };

	size_t N = sizeof(data) / sizeof(float);
	for (size_t i = 0; i < N; i += 3) {
		vv3.push_back(Vector3(data + i));
		vv3.back().cart2spherical();
	}
}

int main(void) {
	try {
		vector<Vector3> thePoints;
		GeneratePoints(thePoints);
		size_t zi, ai, ri;

		Parameter param1(12, 24, 5, 0.0);
		cout << param1 << endl;
		param1.update_nr(20);
		cout << param1 << endl;
		SphericalMesh mesh;
		mesh.create(param1);
		cout << mesh << endl;

		size_t sz = param1.na * param1.nz * param1.nr;
		float *panel1 = new float[sz];
		memset(panel1, 0, sz);
		for (vector<Vector3>::const_iterator iter = thePoints.begin(); iter
				!= thePoints.end(); ++iter) {
			mesh.get_index(*iter, zi, ai, ri);
			cout << *iter << " ";
			panel1[ri * (param1.na * param1.nz) + ai * param1.nz + zi] += 0.01;
			cout << zi << " " << ai << " " << ri << endl;
		}

		vector<size_t> M(1, param1.na * param1.nz);
		vector<size_t> N(1, param1.nr);
		vector<float*> Data(1, panel1);

		write_matfile("./test1.mat", "test1", M, N, Data);

		Parameter param2(12, 24, 5, 0.2);
		cout << param2 << endl;
		param2.update_nr(20);
		cout << param2 << endl;
		mesh.create(param2);
		cout << mesh << endl;

		sz = param2.na * param2.nz * param2.nr;
		float *panel2 = new float[sz];
		memset(panel2, 0, sz);
		for (vector<Vector3>::const_iterator iter = thePoints.begin(); iter
				!= thePoints.end(); ++iter) {
			mesh.get_index(*iter, zi, ai, ri);
			panel2[ri * (param2.na * param2.nz) + ai * param2.nz + zi] += 0.01;
			// must tore as column major for MATLAB
		}

		M[0] = param2.na * param2.nz;
		N[0] = param2.nr;
		Data[0] = panel2;
		write_matfile("./test2.mat", "test2", M, N, Data);

		delete[] panel1;
		delete[] panel2;

	} catch (MyException & e) {
		cout << "<<<<<" << e.what() << ">>>>>>" << endl;
	} catch (...) {
		cout << "Other exception" << endl;
		throw;
	}
	return 0;
}
